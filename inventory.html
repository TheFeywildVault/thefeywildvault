<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Feywild Vault</title>
  <link rel="stylesheet" href="./style/save.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Optional: Toggle dark mode on load
    if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  </script>
</head>

<body class="bg-white text-gray-900 dark:bg-gray-900 dark:text-white transition-colors duration-300 font-sans">

<!-- NAVBAR -->
<header class="bg-white dark:bg-gray-800 shadow-md">
  <div class="container mx-auto px-4 py-4
              flex flex-col gap-3
              md:flex-row md:items-center md:justify-between">

    <!-- Logo + Title (always first row on mobile) -->
    <div class="flex items-center space-x-3 order-1 md:order-none">
      <a href="./">
        <img id="Logo" src="./img/favicon.ico"
             alt="the outline of a d20 dice"
             class="w-8 h-8 flex-shrink-0" />
      </a>
      <a href="./" class="text-2xl font-bold tracking-tight whitespace-nowrap">
        The Feywild Vault
      </a>
    </div>

    <!-- Nav + Account on one row (mobile) -->
    <div class="flex flex-row flex-wrap justify-center items-center gap-4 order-2
                md:justify-end md:gap-4">

      <!-- NAV LINKS -->
      <nav class="flex flex-wrap justify-center 
            gap-x-2 gap-y-1 text-sm
            md:gap-x-4 md:text-base md:gap-y-0">
      <a href="./" class="hover:underline">Home</a>
      <a href="./items" class="hover:underline">Items</a>
      <a href="./inventory" class="hover:underline">Inventory</a>
      <a href="./resources" class="hover:underline">Resources</a>
      <a href="https://www.patreon.com/TheFeywildVault?utm_campaign=creatorshare_creator"
        class="hover:underline">Support</a>
      </nav>

   <!-- ACCOUNT ICON (stays on the same row) -->
<div class="relative z-50">
  <button id="accountBtn" type="button"
    class="w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600
           flex items-center justify-center overflow-hidden
           focus:outline-none focus:ring-2 focus:ring-purple-500">
    <img id="profilePic" src="./img/default-avatar.jpg"
         alt="User profile picture"
         class="w-full h-full object-cover" />
  </button>

  <!-- Dropdown -->
  <div id="accountMenu"
       class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800
              border dark:border-gray-600 rounded shadow-lg hidden">

    <div class="p-4 text-sm text-gray-700 dark:text-gray-200">
      <span id="displayName">Guest</span>
    </div>
    <hr class="border-gray-300 dark:border-gray-600" />

    <a id="loginLink"
       href="./login.html?redirect="
       class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700">
       Login
    </a>

    <a id="signupLink"
       href="./register.html"
       class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700">
       Sign Up
    </a>

    <a id="accountSettingsLink"
       href="#"
       class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 hidden">
       Account
    </a>

    <a id="friendsSettingsLink"
       href="#"
       class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 hidden">
       Friends
    </a>

    <a id="courierLink"
       href="#"
       class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700">
       Courier
    </a>

    <button id="logoutButton"
       class="w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 hidden">
       Logout
    </button>

  </div>
</div>
</div>
</div>
</header>

  <!-- HERO SECTION -->
  <section class="bg-gradient-to-b from-green-200/30 to-transparent dark:from-green-700/10 py-10 text-center">
    <div class="container mx-auto px-4">
        <h2 class="text-4xl md:text-5xl font-bold mb-4 animate-color-fade">
           Inventory
          </h2>
      <p class="text-lg max-w-xl mx-auto text-gray-600 dark:text-gray-300">Save the items you find along the way so you can reference them later on your adventure. Share your rare finds with your fellow adventurers to show off your shiny loot!</p>
    </div>
  </section>

<!-- TEXT INFO SECTION -->

<!-- MAIN CONTENT WITH LEFT COLUMN -->
<section class="container mx-auto px-4 py-2 gap-8">
  
  <!-- Result Output (moved higher in the DOM) -->
<div id="backpack" class="parchment-bg text-black px-10 py-6 rounded shadow-md w-full text-left text-xl leading-snug space-y-4" style="line-height: 1; text-indent: 2px; min-height: 500px;">

<details class="group border brown-border rounded-2xl shadow-md mb-4">
  <summary class="cursor-pointer text-xl font-semibold py-3 px-6 brown-bg-dark brown-text-light rounded-t-2xl select-none">
    Weapons
  </summary>
  <div id="weapon-section" class="p-6 space-y-4 brown-bg-light rounded-b-2xl"></div>
</details>

<details class="group border brown-border rounded-2xl shadow-md mb-4">
  <summary class="cursor-pointer text-xl font-semibold py-3 px-6 brown-bg-dark brown-text-light rounded-t-2xl select-none">
    Armor
  </summary>
  <div id="armor-section" class="p-6 space-y-4 brown-bg-light rounded-b-2xl"></div>
</details>

<details class="group border brown-border rounded-2xl shadow-md mb-4">
  <summary class="cursor-pointer text-xl font-semibold py-3 px-6 brown-bg-dark brown-text-light rounded-t-2xl select-none">
    Wondrous Items
  </summary>
  <div id="wondrous-section" class="p-6 space-y-4 brown-bg-light rounded-b-2xl"></div>
</details>

<details class="group border brown-border rounded-2xl shadow-md mb-4">
  <summary class="cursor-pointer text-xl font-semibold py-3 px-6 brown-bg-dark brown-text-light rounded-t-2xl select-none">
    Scrolls
  </summary>
  <div id="scroll-section" class="p-6 space-y-4 brown-bg-light rounded-b-2xl"></div>
</details>

<details class="group border brown-border rounded-2xl shadow-md mb-4">
  <summary class="cursor-pointer text-xl font-semibold py-3 px-6 brown-bg-dark brown-text-light rounded-t-2xl select-none">
    Ammunition
  </summary>
  <div id="ammunition-section" class="p-6 space-y-4 brown-bg-light rounded-b-2xl"></div>
</details>

</div>


  <!-- Loading GIF -->
  <div id="gifDisplayContainer" class="hidden mt-4 md:col-span-4">
    <img src="./gif/dice.GIF" alt="Loading" id="loadingGif">
  </div>

  <!-- Optional Text -->
  <div class="mt-8 text-gray-600 dark:text-gray-300 md:col-span-4">
    <!-- Add optional content here -->
  </div>
</section>

 
<!-- FOOTER -->
    <footer class="bg-gray-100 dark:bg-gray-900 text-gray-700 dark:text-gray-400 pt-12 pb-8">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-5 gap-8 mb-8 items-start">
  
        <!-- Branding (2/5 columns) -->
        <div class="flex items-start space-x-4 md:col-span-2">
          <img src="./img/favicon.ico" alt="The Feywild Vault logo" class="w-10 h-10 mt-1" />
          <div>
            <h4 class="text-xl font-bold text-gray-900 dark:text-white mb-2">The Feywild Vault</h4>
            <p class="text-sm">Tools and content for D&D adventurers who wander the enchanted paths of the Feywild.</p>
          </div>
        </div>
  
        <!-- Link Sections (3/5 columns, grid distributes space evenly) -->
        <div class="grid grid-cols-3 md:col-span-3 gap-8 justify-items-center">
  
          <!-- Explore -->
          <div>
            <h5 class="text-sm font-semibold text-gray-800 dark:text-gray-200 mb-2">Explore</h5>
            <ul class="space-y-1 text-sm">
              <li><a href="#" class="hover:underline">Home</a></li>
              <li><a href="./items" class="hover:underline">Items</a></li>
              <li><a href="./resources" class="hover:underline">Resources</a></li>
            </ul>
          </div>
  
          <!-- Support -->
          <div>
            <h5 class="text-sm font-semibold text-gray-800 dark:text-gray-200 mb-2">Support</h5>
            <ul class="space-y-1 text-sm">
              <li><a href="https://www.patreon.com/TheFeywildVault?utm_campaign=creatorshare_creator" class="hover:underline">Patreon</a></li>
              <li><a href="https://www.stickermule.com/2e58deb5953f134" class="hover:underline">Stickers</a></li>
            </ul>
          </div>
  
          <!-- Community -->
          <div>
            <h5 class="text-sm font-semibold text-gray-800 dark:text-gray-200 mb-2">Community</h5>
            <ul class="space-y-1 text-sm">
              <li><a href="https://www.facebook.com/profile.php?id=100092475161267" class="hover:underline">Facebook</a></li>
              <li><a href="https://www.instagram.com/thefeywildvault/" class="hover:underline">Instagram</a></li>
              <li><a href="mailto:thefeywildvault@gmail.com" class="hover:underline">Contact</a></li>
            </ul>
          </div>
  
        </div>
      </div>
  
      <div class="border-t border-gray-300 dark:border-gray-700 pt-4 text-center text-xs">
        <p>Â© 2025 The Feywild Vault. All rights reserved.</p>
      </div>
    </div>
  </footer>

<!-- MODAL -->
  <div id="accountModal"
     class="fixed inset-0 bg-black/50 z-50 hidden">
  <div class="flex items-center justify-center h-full w-full">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md relative">
      <button id="closeAccountModal"
              class="absolute top-2 right-2 text-gray-600 dark:text-gray-300 hover:text-red-500 text-lg font-bold">
        &times;
      </button>
      <h2 class="text-xl font-semibold mb-4">Account Settings</h2>

  <div class="mb-4">
    <label class="block text-sm mb-1 text-gray-700 dark:text-gray-200">Profile Picture</label>
    <input type="file" id="avatarUpload" accept="image/*" class="mb-2" />
    <div class="relative w-40 h-40 rounded-full overflow-hidden border-2 border-purple-500 mx-auto">
      <img id="avatarPreview" class="w-full h-full object-cover object-center" src="./img/default-avatar.jpg" />
    </div>
  </div>

  <div class="mb-4">
    <label class="block text-sm mb-1 text-gray-700 dark:text-gray-200">Username</label>
    <input id="accountUsername"
            type="text"
            class="w-full px-3 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-100"
            readonly />
  </div>

  <div class="mb-4">
    <label class="block text-sm mb-1 text-gray-700 dark:text-gray-200">Display Name</label>
    <input id="accountDisplayName"
            type="text"
            class="w-full px-3 py-2 rounded bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 text-gray-900 dark:text-white" />
  </div>

  <button id="saveAccountChanges"
          class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded">
    Save Changes
  </button>

  <p id="accountSaveConfirm" class="text-green-500 mt-3 hidden">Changes saved successfully!</p>
  <br><br>
  <h2 class="text-xl font-semibold mb-4">Patreon</h2>
  <div class="mb-4">

    <!--Patreon Status-->
    <div id="patreonStatus"
        class="text-sm text-gray-900 dark:text-white mb-2">
    </div>

    <!-- Link Button -->
    <a id="patreonLinkBtn"
      href="https://feywildvault-backend.onrender.com/api/patreon/link"
      class="inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded">
      <img src="/img/patreonlogo.png" alt="Patreon" class="w-5 h-5 mr-2">
      Link Patreon Account
    </a>

    <!-- Unlink Button -->
    <button id="patreonUnlinkBtn" class="px-4 py-2 bg-red-700 rounded hidden">Unlink</button>
  
  </div>


    </div>
  </div>
</div>


<div id="friendsModal" class="fixed inset-0 bg-black/50 z-50 hidden">
  <div class="flex items-center justify-center h-full w-full">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md relative max-h-[90vh] overflow-y-auto">
      <button id="closeFriendsModal"
              class="absolute top-2 right-2 text-gray-600 dark:text-gray-300 hover:text-red-500 text-lg font-bold">
        &times;
      </button>
      <h2 class="text-xl font-semibold mb-4">Manage Friends</h2>

      <div class="mb-4">
        <label for="friendSearchInput" class="block text-sm mb-1 text-gray-700 dark:text-gray-200">Search by Username</label>
        <div class="flex space-x-2">
          <input id="friendSearchInput" type="text" placeholder="Enter username"
                 class="flex-grow px-3 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-100" />
          <button id="friendSearchBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded">Add Friend</button>
        </div>
        <p id="friendSearchMessage" class="mt-2 text-sm text-red-500 hidden"></p>
      </div>

      <h3 class="text-lg font-semibold mb-2">Your Friends</h3>
      <ul id="friendsList" class="space-y-2 max-h-64 overflow-y-auto">
        <!-- Friends list items will be populated here -->
      </ul>
    </div>
  </div>
</div>

<div id="shareModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white dark:bg-gray-800 rounded p-6 max-w-md w-full relative">
    <button onclick="closeShareModal()" class="absolute top-2 right-2 text-gray-700 dark:text-gray-300 font-bold">X</button>
    <h2 class="text-lg font-semibold mb-4">Share with a friend</h2>
    <ul id="shareFriendsList" class="space-y-2 max-h-60 overflow-auto"></ul>
  </div>
</div>

<!-- Courier Modal -->
<div id="courierModal" class="fixed inset-0 bg-black/50 z-50 hidden">
  <div class="flex items-center justify-center h-full w-full">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md relative max-h-[90vh] overflow-y-auto">

      <!-- X Close Button like friendsModal -->
      <button id="closeCourierModal"
              class="absolute top-2 right-2 text-gray-600 dark:text-gray-300 hover:text-red-500 text-lg font-bold">
        &times;
      </button>

      <h2 class="text-xl font-semibold mb-4">Courier Inbox</h2>

      <ul id="courierInboxList" class="space-y-2 max-h-64 overflow-y-auto">
        <!-- Courier inbox items will be populated here -->
      </ul>
    </div>
  </div>
</div>

<!-- Item Shared Popup -->
<div id="itemSharedPopup" class="fixed top-[280px] left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-50 hidden transition-all duration-300">
  Item shared successfully!
</div>

<script>
  function toggleDropdown(id) {
    const dropdown = document.getElementById(id);
    dropdown.classList.toggle('hidden');
  }

  document.addEventListener("DOMContentLoaded", () => {
  const unlinkBtn = document.getElementById("patreonUnlinkBtn");
  if (!unlinkBtn) return;

  unlinkBtn.addEventListener("click", async () => {
    const res = await fetch("/api/patreon/unlink", { method: "POST" });
    const json = await res.json();

    if (json.success) {
      window.location.reload();
    } else {
      alert("Failed to unlink Patreon");
    }
  });
});

</script>

<script src="/js-code/rmig.js?v=3" defer></script>
<script src="/js-code/account.js?v=3" defer></script>
<script src="/js-code/item-save.js" defer></script>
<script src="/js-code/item-share.js" defer></script>
<script src="/js-code/item-toggle-button.js" defer></script>
<script src="/js-code/item-filter-tooltip.js" defer></script>
<script src="/js-code/item-type-selection.js" defer></script>
<script src="/js-code/favicon.js" defer></script>

<div id="confirmPopup" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-gray-800 text-white rounded-lg p-6 max-w-sm w-full text-center shadow-lg">
    <p class="mb-4">Are you sure you want to remove this item?</p>
    <div class="flex justify-center gap-4">
      <button id="confirmYes" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Yes</button>
      <button id="confirmNo" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">No</button>
    </div>
  </div>
</div>

</body>
</html>